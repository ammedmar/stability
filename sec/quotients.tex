% !TEX root = ../vr_st.tex

\subsection{General quotients}

\subsubsection{}

%An action of a group $G$ on a set $X$ is a function $G\times X\to X$ such that $g\cdot (h\cdot x)=(gh)\cdot x$, and $e\cdot x = x$ for all $x\in X$ and $g,h\in G$, where $e$ is the identity element of $G$.

Let $G$ be a group acting on a metric space $\cX$, we denote its orbit space with the quotient topology by $\cX_G$.
Orbits will be denoted as $[x]$ for $x \in \cX$.
We say the action of $G$ is \defn{proper} if, for every $x \in \cX$, there is some $r>0$ such that $\{g \mid g\cdot B(x,r) \cap B(x,r) = \emptyset\}$ is finite.
We say $G$ \defn{acts by isometries} on $\cX$, if the map $g \colon \cX \to \cX$ is an isometry for every $g \in G$.

Let $G$ be a group acting properly and by isometries on a metric space $\cX$.
Then the \defn{quotient metric}, defined by
\[
d_{\cX_G}\big([x], [x']\big) = \inf_{g \in G} d_\cX(x, g \cdot x'),
\]
is well-defined on $\cX_G$.

The action of a group $G$ on $\cX$ is said to be \defn{$r^*$-diameter}, where $r > 0$, if for any non-negative integer $k$, the condition $\diam_{\cX_G}\set[\big]{[x_0],\dots,[x_k]} < r$ implies the existence of a unique choice of $g_i$ for each $i \in \set{1,\dots,k}$ such that $\diam_{\cX}\set{x_0, g_1x_1, \dots, g_kx_k} < r$.
% \anibal{Please finish this. Why \(r \neq 0\)? Whats the quantifier: for all or there is?
% 	\ling{We need to be careful with the citation here: (1) cite \cite{adams2022metric} for the original definition; (2) cite Liam Barham for the fixed definition. We should ask Liam Barham for permission to cite his unpublished work.}}
% \anibal{I ask this below, but here is the appropriate place to answer: Does \(r^*\)-diam imply proper?}

\subsubsection{}\label{subsub:h}

A \(G\)-action on $\cX$ induces a natural \(G\)-action on the Vietoris--Rips complex $\VR(\cX)$.
Explicitly, for any \(r > 0, g\in G\) and $\sum \lambda_i x_i \in \VR_r(\cX)$,
\[
g \cdot \sum \lambda_i x_i = \sum \lambda_i (g\cdot x_i).
\]
With respect to this action, there is an induced map on orbit spaces given by
\begin{align*}
	\tilde h_r \colon \VR_r(\cX_G) &\to \VR_r(\cX)_G \\
	\textstyle\sum\lambda_i [x_i] &\mapsto \textstyle \big[\sum\lambda_i x_i\big].
\end{align*}
If the action is proper and by isometries as well as \(r^*\)-diameter, then for any \(s \leq r\), the map $\tilde{h}_s$ is a simplicial isomorphism.
This result was initially stated in \cite[Prop.~3.5]{adams2022metric} under a weaker assumption than the \(r^*\)-diameter condition.
A counterexample to the original statement and the above corrected one were provided by Liam Barham \cite{bibid}.

% \medskip\lemma
% Let $G$ act properly and by isometries on $\cX$.
% If the \(G\)-action is a $t^*$-diameter action then, for any \(s < t\), the map \((h_s)_G\) is a simplicial isomorphism.\footnote{A lot to explain here, including the assumptions, the counterexample, and the change in the notation wrt the original. Confusingly, \(h\) here is the inverse of \(\tilde h\) there.}

% \begin{proof}
% 	Because $G$ acts by isometry, we have a well-defined map
% 	\[
% 	\tilde{h} \colon \VR_r\cX \to \VR_r(\cX_G)
% 	\text{ with }
% 	\sum_{i=1}^k \lambda_i x_i \mapsto \sum_{i=1}^k \lambda_i [x_i],
% 	\]
% 	Because two points in the same orbit of the $G$ action always have the same image under $\tilde{h}$, it induces a map $\tilde{h}_G \colon (\VR_r\cX)_G \to \VR_r(\cX_G)$.

% 	Moreover, $\tilde{h}_G$ is an isomorphism, following from the fact that the action of $G$ on $\cX$ is an $r^*$-diameter action; see \cite[Proposition 3.5]{adams2022metric} for further details.
% 	Therefore, $h$, the inverse of $\tilde{h}_G$, is also an isomorphism.
% \end{proof}

\subsection{Quotients of spheres}

\subsubsection{}
\label{subsub:VR-compatible-Sn}
A \(G\)-action on \(\bS^n\) which is both proper and by isometries is said to be \defn{\(\VR\)-compatible} if, for each $r \in (0, \zeta_n]$, it commutes with the \(\VR_r(\bS^n)\)-projection (see \cref{ss:VRSn projection}) and the induced map
\[
\tilde f_r^n \colon \VR_r(\bS^n)_G \to \bS^n_G,
\]
is a weak equivalence.
For example, based on the results in \cref{ss:VRSn projection}, the trivial action is \(\VR\)-compatible.

\subsubsection{}
\label{subsub:VR-compatible-system}
An \defn{equatorial system} is a diagram
\[
\bS^{n_1} \to \bS^{n_2} \to \bS^{n_3} \to \dotsb
\]
where each arrow is an isometric embedding and $n_i \in \N$.
For example, the real and complex equatorial systems
\[
\bS^1 \subset \bS^2 \subset \bS^3 \subset \dotsb
\quad\text{and}\quad
\bS^1 \subset \bS^3 \subset \bS^5 \subset \dotsb,
\]
used for the definition of real projective (\cref{sss:cohomology_rpn}) and Lens spaces (\cref{sss:cohomology_lens}), are defined by the canonical inclusions
\[
\R^2 \subset \R^3 \subset \R^4 \subset \dotsb
\quad\text{and}\quad
\bC \subset \bC^2 \subset \bC^3 \subset \dotsb.
\]

\subsubsection{}
\label{subsub:system VR compatible}

A \defn{\(G\)-action} on an equatorial system consists of a \(G\)-action on each sphere commuting with the isometric embeddings.
For example, the group \(\rC_2 = \set{1,-1} \subset \R\) acts antipodally on the real equatorial system.
Similarly, for \(q \in \N\), the multiplicative subgroup \(\rC_q\) of \(q\)-roots of unity acts on the complex equatorial system.

We say that a \(G\)-action on an equatorial system is \defn{\(\VR\)-compatible} if the \(G\)-action on each sphere is \(\VR\)-compatible and the following diagram commutes for every \(i \in \N\) and $0 < r < \zeta_{n_{i+1}}$:
\begin{equation}\label{eq:VR_quotient}
    \begin{tikzcd}
	\VR_r(\bS^{n_i})_G
	\ar[d, hook]
	\ar[r, "\tilde f_{\,r}^{\,n_i}" above]
	&
	\bS^{n_i}_G
	\ar[d, hook]
	\\
	\VR_r(\bS^{n_{i+1}})_G
	\ar[r, "\tilde f_{\,r}^{\,n_{i+1}}" above]
	&
	\bS^{n_{i+1}}_G.
\end{tikzcd}
\end{equation}

%where
%\[
%\rho_r^n \colon \VR_r(\bS^n)_G \xra{\tilde h_r} \VR_r(\bS^n)_G \xra{\tilde f_r^n} \bS^n_G.
%\]

%\anibal{I don't know what you are proving in the hidden text below. Also, the commutativity with \(\tilde h\) should be immediate, at least on a range. Maybe the lemma below is what you want to use your proof for?}

\lemma The above \(\rC_2\)-action on the real equatorial system and the \(\rC_q\)-action on the complex one are \(\VR\)-compatible for every \(q \in \N\).

\begin{proof}
    Take any $n \in \N$ and arbitrary $0 < r \leq \zeta_{n+1} (< \zeta_{n})$.
    The commutativity of diagram \ref{eq:VR_quotient}, with $n_i = n$ and $n_{i+1} = n+1$ follows directly from the commutativity of the corresponding diagram without group actions.

    It remains to check that the group action on each sphere $\bS^n$ is \(\VR\)-compatible (see \cref{subsub:VR-compatible-Sn}), which means the group action commutes with the $\VR_r(\bS^{n})$-projection $f_r^{n}\colon \VR_r(\bS^{n}) \to \bS^{n}$ and $f_r^{n}$ induces weak equivalences on the orbit spaces.

    In the case of $\rC_2$-action on the real equatorial system, verifying that the $\rC_2$-action commutes with $f_r^{n}$ is straightforward.
    By \cref{ss:VRSn projection}, $f_r^{n}$ is a homotopy equivalence.
    Because the $\rC_2$-action is proper and free, the $\rC_2$-equivariant homotopy equivalence $f_r^n$ induces homotopy equivalence (and thus weak equivalence) on the orbit spaces.

    The case of $\rC_q$-action on the complex equatorial system follows from a similar argument.
    %In the case of the $\rC_2$-action, because $f_r^{n}$ is $\rC_2$-equivariant, the induced map $\tilde{f}_r^{n}$ is also a homotopy equivalence. \ling{This is the argument used by \cite[Theorem 4.5]{adamaszek2018metric}, but I am not sure why it is true and I am not sure if it generalizes to $\rC_m$-actions.\anibal{Since the action is proper and free, a weak equivalence equivariant wrt the action induces a weak equivalence of orbits. It is easy to see that \(f\) is equivariant wrt the \(\bS^1\) action defining the action of \(\cyc_q\)}}
\end{proof}

\subsubsection{}\label{ss:fundamental_lemma}

A \(G\)-action on an equatorial system is said to be \defn{free} if the \(G\)-action on every sphere is free.
% In this case, each orbit space is a closed manifold which is equipped with the quotient metric.

\medskip\lemma Consider a free $\VR$-compatible $G$-action on an equatorial system
\[
\bS^{n_1} \to \bS^{n_2} \to \bS^{n_3} \to \dotsb.
\]
If $\fillrad(\bS^{n_i}_G)$ is non-decreasing as a function of \(i\) then, for any \(i \leq j\),
\[
\firstdeath{n_i}{\bS^{n_j}_G} \leq \fillrad(\bS^{n_j}_G).
\]

\begin{proof}\anibal{Ling: Did we decide to use the parenthesis on VR? \ling{We did not reach a conclusion.}}
    To simplify notation, for any $i \leq j$, let
    \[
        \cX_j = \bS^{n_j}_G, \,\delta_j = \fillrad(\cX_j) \text{ and }\beta_i^j = \firstdeath{n_i}{\cX_j}.
    \]
	We will use an induction argument on $j$.
	When $j = 1$, because $\cX_1$ is connected and $n_1$-dimensional, we apply results in \cref{ss:beta v.s. fillrad} to deduce that $\beta_1^1 = \delta_1$.
	%Because $\delta_1 \leq \alpha_1$, $\rH_1(\VR\bS^1_G)$ retains the same isomorphism type before $\delta_1$, implying that $\beta_{1, 1} \geq \delta_1$.
	%Thus, $\beta_{1, 1} =\delta_1$.

	Assume the statement holds for $\cX_{j-1}$, that is, $\beta_i^{j-1} \leq \delta_{j-1}$ for any $i \leq j-1$.
	Since $\delta_{j-1} \leq \delta_j$, we have the following commutative diagram of topological spaces for any $r,\epsilon>0$ small:
    \begin{equation}\label{d:fundamental_bars_diagram}
        \begin{tikzcd}
            \cX_{j-1}
            \ar[d, hook,"{\iota}" left]
            &
            \VR_r\cX_{j-1}
            \ar[d, hook,"\iota_r" left]
            \ar[l, "\rho^{j-1}" above]
            \ar[r, hook, "v^{j-1}"]
            &
            \VR_{\delta_{j-1}+\epsilon}\cX_{j-1}
            \ar[d, hook]
            \\
            \cX_j
            &
            \VR_r\cX_j
            \ar[l, "\rho^j" below]
            \ar[r, hook, "v^j" below]
            &
            \VR_{\delta_j+\epsilon}\cX_j.
        \end{tikzcd}
    \end{equation}
    Here, the vertical maps are all induced by the equatorial inclusion of the orbit spaces $\iota \colon \cX_{j-1} \hookrightarrow \cX_j$.
    The horizontal inclusion $v^{j-1}$ (resp. $v^j$) in the right-hand-side square is the inclusion map in the corresponding Vietoris--Rips filtration.
    The horizontal map $\rho^{j-1}$ in the left-hand-side square is the composition of the following maps introduced in \cref{subsub:h} and \cref{ss:VRSn projection}, respectively:
    \[\VR_r\cX_{j-1} \xrightarrow{\tilde{h}_r}\VR_r(\bS^{n_{j-1}})_G \xrightarrow{\tilde{f}_r^{n_{j-1}}} \cX_{j-1}.\]
    The horizontal map $\rho^j$ is defined in a similar way.

    For any $i \leq j-1$, applying the degree $n_i$ reduced homology functor to diagram (\ref{d:fundamental_bars_diagram}) and using the fact that the $\rC_2$-action on the system is $\VR$-compatible (cf. \cref{subsub:system VR compatible}), we obtain a commutative diagram of vector spaces:
	for $r,\epsilon>0$ small,
	\begin{equation}\label{eq:diagram of H}
	\begin{tikzcd}[column sep = 5em]
		\rH_{n_i}(\cX_{j-1})
		\ar[d, "\cong" left]
		&
		\rH_{n_i}(\VR_r\cX_{j-1})
		\ar[d, "\rH_{n_i}(\iota_r)" left, "\cong" right, myred]
		\ar[l, "\cong" above]
        %\ar[l, "(1)" below]
		\ar[r, "\rH_{n_i}(v^{{j-1}})", myred]
		&
		\rH_{n_i}(\VR_{\delta_{j-1}+\epsilon}\cX_{j-1})
		\ar[d]
		\\
		\rH_{n_i}(\cX_j)
		&
		\rH_{n_i}(\VR_r \cX_j)
		\ar[l, "\cong"]
        %\ar[l, "(2)" above]
		\ar[r, "\rH_{n_i}(v^j)" below, myred]
		&
		\rH_{n_i}(\VR_{\delta_n+\epsilon}\cX_j).
	\end{tikzcd}
	\end{equation}

	Let $\sigma_i$ be a representative cycle for the bar $(0,\, 2\beta_{i}^{j-1})$ in $\VR \cX_{j-1}$.
	Commutativity of the left-hand-side square of diagram (\ref{eq:diagram of H}) implies that $\rH_{n_i}(\iota_r)$ is an isomorphism.
    As $r$ is arbitrarily small, we obtain that $\rH_{n_i}(\iota_r)(\sigma_i)$ creates a bar born at $0$.
	Moreover, this bar dies after $\delta_j$ as explained below.
    It follows from the induction hypothesis $\beta_i^{j-1} \leq \delta_{j-1}$ that $\sigma_i$ dies after $\delta_{j-1}$, implying that $\rH_{n_i}(v^{{j-1}})(\sigma_i) = 0$.
	Using the right-hand-side square's commutativity, we have $(\rH_{n_i}(v^j) \circ \rH_{n_i}(\iota_r))(\sigma_i)=0$, which means $\rH_{n_i}(\iota_r)(\sigma_i)$ dies after $\delta_j+\epsilon$.
    Since this holds for any \(\epsilon > 0\), we conclude that \(\beta_i^j \leq \delta_j\).

	For the case when $i = j$, apply results in \cref{ss:beta v.s. fillrad} again to get that $\beta_j^j = \delta_j$.
	This completes the proof.
\end{proof}
