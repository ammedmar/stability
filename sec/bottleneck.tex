% !TEX root = ../vr_st.tex

\section{Gromov--Hausdorff estimates}\label{s:gh_estimates}

In this section, we aim to construct examples of Riemannian (pseudo-)manifolds for which the Gromov--Hausdorff estimate derived from the stability of persistent cohomology operations provides tighter bounds than those obtained through persistent homology.
This demonstrates the enhanced discriminatory power of these persistent invariants in the context of metric geometry.

Specifically, let us consider, for any \(n \leq 2\), the wedge of Riemannian spheres \(\VS = \bS^1 \vee \dots \vee \bS^n\), where each \(\bS^i\) has diameter \(\pi\).
Additionally, we consider \(\rp^n\), the real projective space obtained as the quotient of \(\bS^n(2)\) under the antipodal action, where \(\bS^n(2)\) denotes the \(n\)-dimensional sphere of radius 2, and the resulting quotient space \(\rp^n\) also has diameter \(\pi\).
Then,

\medskip (1) For any \(m \in \N\) one has
\[
\di\Big(\rH^\VR_m(\VS),\, \rH^\VR_m(\rp^n)\Big) < \frac{\pi}{4}.
\]

(2) There is \(\degp \in \N\) and \(\Sq^k \in \cO(\degp-k, \degp)\) such that
\[
\di\Big(\img_{\Sq^k}^\VR(\VS),\, \img_{\Sq^k}^\VR(\rp^n)\Big) \geq \frac{\pi}{3}.
\]

We will prove more general statements with the goal of proving similar estimates for Lens spaces.

\subsection{General estimates}

\label{ss:genberal_distance_comparison}

Let $\cX$ be a closed connected \(n\)-manifold of diameter $\pi$ such that
\begin{itemize}
    \item $\Rad_{htpy}(\cX) \geq \zeta_n $;
    \item $2\firstdeath{m}{\cX} < \tfrac{\zeta_n}{2}+\zeta_m$ for any $m \in N$.
\end{itemize}
Here, $\zeta_n = 2 \cdot \Rad(\bS^n)= \arccos{(-\tfrac{1}{n+1})}$ for any $n\geq 1$.
Let $\VS$ be the wedge of unit geodesic spheres with the same reduced homology groups as $\cX$.
More precisely, $\VS \defeq \VS^{u_1, \dots, u_n}$ with $u_i = \dim \opH_i(\cX)$ for each $i = 1,\dots, n$.

We establish the following result to show that the $\theta$-barcodes can provide a better (lower-bound) approximation of the Gromov--Hausdorff distance between $\cX$ and $\VS$ than $\db$ between the persistent homology barcodes.

\medskip\theorem
For any $m \in \N$ and $\theta \in \cO(\ell, m)$ such that $\img \theta_\cX$ is non-zero, we have
\begin{equation}\label{eq:comparison}
    \di \Big(\rH^{\VR}_{m}(\VS),\, \rH^{\VR}_{m}(\cX)\Big) < \di \big(\img^{\VR}_{\theta}(\VS),\, \img^{\VR}_{\theta}(\cX)\big) .
\end{equation}

The proof of the above theorem involves the following three steps, which we will prove in \cref{sss:db_upper_bound}, \cref{sss:db_theta_lower_bound} and \cref{sss:comparison_lemma_zeta_n}, respectively.
\begin{enumerate}
    \item [(a)] LHS of \cref{eq:comparison} is bounded above by $\max\big\{|\zeta_m  - 2\firstdeath{m}{\cX} |, \tfrac{\pi - \zeta_n}{2}\big\}$.
    \item [(b)] RHS of \cref{eq:comparison} is bounded below by $\min\{\firstdeath{\theta}{\cX}, \zeta_n\}$.
    \item [(c)] The value in (a) is strictly less than the value in (b).
\end{enumerate}
Thus, LHS of \cref{eq:comparison} is strictly less than RHS of \cref{eq:comparison}.

\subsubsection{}\label{sss:db_upper_bound}

\medskip\lemma
If \( \opH_m(\cX) \) is non-zero, then
\begin{equation}\label{eq:db_usual_upper_bound}
    \di\Big(\rH^{\VR}_{m}(\VS),\, \rH^{\VR}_{m}(\cX)\Big)
	\leq \max\big\{|\zeta_m  - 2\firstdeath{m}{\cX} |,\, \tfrac{\pi - \zeta_n}{2}\big\}.
\end{equation}
If \( \opH_m(\cX) \) is zero, a similar result holds, with the upper bound being $\tfrac{\pi - \zeta_n}{2}$.

\begin{proof}
    Because both metric spaces are totally bounded, their persistent homology is q-tame.
    By \cref{ss:algebraic_stability}, the interleaving distance between their persistent homology equals the bottleneck distance between the corresponding barcodes.

    To obtain an upper bound on the bottleneck distance, we only need to construct a matching and calculate its cost. Let \( \beta_m = 2\firstdeath{m}{\cX} \).

    First, suppose \( \opH_m(\cX) \) is non-zero.
    Consider the matching \( P \) between \( \Hbarc[\field]{m}{\VS} \) and \( \Hbarc[\field]{m}{\cX} \) such that the bar \( (0, \zeta_m) \) from \( \Hbarc[\field]{m}{\VS} \) is matched to \( (0, \beta_m) \) from \( \Hbarc[\field]{m}{\cX} \), with all other bars remaining unmatched. Using the estimates from \cref{fig:barcodes_general} and \cref{fig:barcodes_vs}, we find that the cost of \( P \) satisfies
    \begin{align*}
        \cost(P)
        = & \max\Big\{|\zeta_m - \beta_m|,\, \frac{\pi - \zeta_n}{2},\, \frac{\pi - \Rad_{htpy}(\cX)}{2}\Big\} \\
        = & \max\Big\{|\zeta_m - \beta_m|,\, \frac{\pi - \zeta_n}{2}\Big\} \quad \text{(since \( \zeta_n \leq \Rad_{htpy}(\cX) \))}.
    \end{align*}
    Thus, \cref{eq:db_usual_upper_bound} follows.

    Now, suppose \( \opH_m(\cX) \) is zero. In this case, the matching where all bars are unmatched has a cost no larger than \( \frac{\pi - \zeta_n}{2}\).
\end{proof}

\subsubsection{}\label{sss:db_theta_lower_bound}

\medskip\lemma
Let $\theta \in \cO(\ell, m)$ be such that $\img \theta_\cX$ is non-zero.
Then,
\begin{equation}\label{eq:db_theta_lower_bound}
	\di\big(\img^{\VR}_{\theta}(\VS), \img^{\VR}_{\theta}(\cX)\big)
    %\db\big(\thetabarc{\VS}, \thetabarc{\cX}\big)
	%= \min_Q \cost(Q)
	\geq \min\{\firstdeath{\theta}{\cX}, \zeta_n\}. %\geq \tfrac{\zeta_n}{2}.
\end{equation}

\begin{proof}
    Since both metric spaces are totally bounded, their persistent cohomology is q-tame, making the persistent $\img_\theta$-modules q-tame as well (see \cref{ss:theta-modules-q-tame}).
    Thus, the left-hand-side of \cref{eq:db_theta_lower_bound} can be replaced with the bottleneck distance between the corresponding $\img_\theta$-barcodes.

    To establish a lower bound on this bottleneck distance, we need to compute the minimum cost of matching specific bars.

    Let \( \gamma_\theta = 2\firstdeath{\theta}{\cX} \).
    From \cref{fig:barcodes_general}, note that \( \thetabarc{\cX} \) contains a bar \( (0, \gamma_\theta) \).
    We now calculate the minimum cost of matching this bar.

    Consider an arbitrary matching \( Q \) between \( \thetabarc{\VS} \) and \( \thetabarc{\cX} \).
    There are two cases to analyze.
	If $(0,\gamma_\theta )$ is unmatched in $Q$, then $\cost(Q)$ is at least $ \tfrac{\gamma_\theta }{2}$.
	If $(0,\gamma_\theta )$ is matched to some bar $(a,b) \in \thetabarc{\VS}$, then
	$\cost(Q) =  \|(0,\gamma_\theta ) - (a,b)\|_\infty \geq a \geq \zeta_n$, because $(a,b) \subset (\zeta_n, \pi)$.
	Thus, any matching $Q$ must satisfy $\cost(Q) \geq \min\{\tfrac{\gamma_\theta }{2}, \zeta_n\}$, which proves \cref{eq:db_theta_lower_bound}.
\end{proof}


\subsubsection{}
\label{sss:comparison_lemma}

The following results will be used in \cref{sss:comparison_lemma_zeta_n} and \cref{ss:distance_estimate_rpn}.

As before, let $\zeta_n = \arccos{(-\tfrac{1}{n+1})}$, which decreases as $n$ increases.
We derive the following lemma, which, while straightforward, requires careful exposition.

\medskip\lemma
Let $m \leq n$.
\begin{enumerate}
    \item \(\zeta_m - \zeta_n < \tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}.\)

    \item For any $r \in \big[\zeta_n, \tfrac{\zeta_n}{2}+\zeta_m\big)$, $\max\big\{|\zeta_m  - r |, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}$.

    \item For any $r \in \big[\zeta_n, \tfrac{\pi - \zeta_n}{2} + \zeta_m\big]$, $\max\{|\zeta_m  - r |, \tfrac{\pi - \zeta_n}{2}\} = \tfrac{\pi - \zeta_n}{2}$.
\end{enumerate}


\begin{proof}
    	(1) The first inequality follows from $\zeta_m - \zeta_n < \tfrac{\pi}{6} < \tfrac{\pi - \zeta_n}{2}$.
        The second inequality holds because $\zeta_n > \tfrac{\pi}{2}$.

        (2) Since $\tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}$, it remains to show $|\zeta_m  - r | < \tfrac{\zeta_n}{2}$, which follows from
    	\(
    	|\zeta_m  - r | < \max\big\{\zeta_m - \zeta_n, \tfrac{\zeta_n}{2}\big\} = \tfrac{\zeta_n}{2},
    	\) by Part (1).

    	(3) %Assume, in addition, $r \leq \tfrac{\pi - \zeta_n}{2} + \zeta_m$.
        It suffices to show $|\zeta_m  - r | \leq \tfrac{\pi - \zeta_n}{2}$.
        We consider two cases.
        When $r > \zeta_m$, we have
    	$|\zeta_m  - r | = r - \zeta_m \leq
    	%\leq \tfrac{\pi - \zeta_n}{2} + \zeta_m - \zeta_m =
        \tfrac{\pi - \zeta_n}{2}
    	$ by the assumption on $r$.
    	When $r \leq \zeta_m$, we have
    	\(
    	|\zeta_m  - r | \leq \zeta_m - \zeta_n
    	< \tfrac{\pi - \zeta_n}{2}
    	\) by Part (1).
\end{proof}

\subsubsection{}
\label{sss:comparison_lemma_zeta_n}

We will finish the proof of \cref{ss:genberal_distance_comparison} by completing the third step.
%demonstrating that the upper bound on the interleaving distance for the persistent homology is strictly less than the lower bound for the interleaving distance between the persistent $\img_\theta$-modules.

\medskip \lemma
For any $m \in \N$ and $\theta \in \cO(\ell, m)$ such that $\img \theta_\cX$ is non-zero,
\[\max\big\{|\zeta_m  - 2\firstdeath{m}{\cX} |, \tfrac{\pi - \zeta_n}{2}\big\} < \min\{\firstdeath{\theta}{\cX}, \zeta_n\}.\]
\begin{proof}
    Let $\beta_m = 2\firstdeath{m}{\cX}$ and $\gamma_\theta = 2\firstdeath{\theta}{\cX}$.
    Because \(\zeta_n \leq \Rad_{htpy}(\cX) \leq \beta_m < \tfrac{\zeta_n}{2} + \zeta_m\), $\beta_m$ satisfies the condition in Part (2) of the above lemma.
    Thus, we have the leftmost inequality below:
    \[
    \max\big\{|\zeta_m - \beta_m|, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}
    \leq
    \min\big\{\tfrac{\gamma_\theta}{2}, \zeta_n\big\}.
    \]
    To obtain the rightmost inequality, note that \(\zeta_n \leq \Rad_{htpy}(\cX) \leq \gamma_\theta\).
\end{proof}

\subsection{Real projective spaces}\label{ss:distance_estimate_rpn}

For \(\cX = \rp^n\) and cohomology operations \(\theta\) as Steenrod squares (mod 2 coefficients), we obtain a sharper comparison of the interleaving distances, summarized in the theorem below, where \(\VS = \bS^1 \vee \dots \vee \bS^n\).

\medskip\theorem
(1) For any \(n,m \in \N\), one has
\[
\di\Big(\rH^\VR_m(\VS),\, \rH^\VR_m(\rp^n)\Big) < \frac{\pi-\zeta_n}{2}.
\]

(2) For any \(n,m,k \in \N\) such that $m \leq n,\, k \leq \tfrac{n-1}{2},\, \binom{m-k}{k}$ odd and $\Sq^k\in \cO(m-k, k)$, one has
\[
\di\Big(\img_{\Sq^k}^\VR(\VS),\, \img_{\Sq^k}^\VR(\rp^n)\Big) \geq \frac{\pi}{3}.
\]

\begin{proof}
    (1) %Let $\beta_m = 2\firstdeath{m}{\rp^n}$.
    When $1 \leq m \leq n$, we have shown in \cref{ss:first_critical_value_rpn} that
    $2\firstdeath{m}{\rp^n} = \tfrac{2\pi}{3}$, which lies in $\big[\zeta_n,\, \tfrac{\pi - \zeta_n}{2}+\zeta_m\big]$.
    This satisfies the condition of Part (3) of the lemma in \cref{sss:comparison_lemma}.
	By applying \cref{eq:db_usual_upper_bound} and \cref{sss:comparison_lemma}, we get
	\[\di\Big(\rH^\VR_m(\VS),\, \rH^\VR_m(\rp^n)\Big)
    \leq
    \max \big\{ |\zeta_m  - \tfrac{2\pi}{3} |, \tfrac{\pi - \zeta_n}{2} \big\}
    = \tfrac{\pi - \zeta_n}{2}.\]
    When $m > n$, $\rH_m(\rp^n)$ is zero.
    Using \cref{sss:comparison_lemma}, the interleaving distance is again bounded above by $\tfrac{\pi - \zeta_n}{2}$.

    (2) With $m,k$ satisfying the required conditions, we have shown in \cref{ss:first_critical_value_rpn} that
	$\firstdeath{\Sq^k}{\rp^n} = \tfrac{2\pi}{3}$.
    Applying \cref{eq:db_theta_lower_bound}, we have
	\[\di\Big(\img_{\Sq^k}^\VR(\VS),\, \img_{\Sq^k}^\VR(\rp^n)\Big)
	\geq \min\Big\{\tfrac{\pi}{3},\, \zeta_n\Big\}
	= \tfrac{\pi}{3}.\qedhere
    \]
\end{proof}

As \(n\) grows, \(\tfrac{\pi - \zeta_n}{2}\) increases and approaches \(\tfrac{\pi}{4}\), showing that Steenrod barcodes can provide a more refined lower bound on the Gromov--Hausdorff distance compared to persistent homology in all degrees.