% !TEX root = ../vr_st.tex

\section{Gromov--Hausdorff estimates}\label{s:gh_estimates}

In this section, we aim to construct examples of Riemannian (pseudo-)manifolds for which the Gromov--Hausdorff estimate derived from the stability of persistent cohomology operations provides tighter bounds than those obtained through the stability of persistent homology.
This demonstrates the enhanced discriminatory power of these persistent invariants in the context of metric geometry.

Specifically, we consider for \(n > 1\) the real projective \(n\)-space obtained as the quotient of \(\bS^n(2)\), the Euclidean sphere of radius 2, under the antipodal action.
We mention that this quotient space \(\rp^n\) has diameter \(\pi\).
Let us also consider the wedge of Euclidean spheres of diameter \(\pi\) with the same homology \(\bS_{\rp^n} = \bS^1 \vee \dots \vee \bS^n\).
Then, as a consequence of \cref{ss:distance_estimate_rpn}, we have

\medskip (1) For any \(m \in \N\) one has
\[
\di\Big(\rH^\VR_m(\bS_{\rp^n}),\, \rH^\VR_m(\rp^n)\Big) < \frac{\pi}{4}.
\]

(2) There is \(\degp \in \N\) and \(\Sq^k \in \cO(\degp-k, \degp)\) such that
\[
\di\Big(\img_{\Sq^k}^\VR(\bS_{\rp^n}),\, \img_{\Sq^k}^\VR(\rp^n)\Big) \geq \frac{\pi}{3}.
\]

\subsection{General estimates}\label{ss:genberal_distance_comparison}

\subsubsection{}

We will prove the relevant statements for the above inequalities in greater generality, allowing for similar estimates to be established for Lens spaces once their critical radii are determined.

Let $\cM$ be a closed connected \(n\)-manifold of diameter $\pi$.
% and, as before, $\zeta_n = \arccos{(-\tfrac{1}{n+1})}$.
% We are mostly thinking of a quotients of round spheres.
Below is a list of properties that we want from one such space.

\medskip\noindent\textit{\darkblue Desiderata}.\
\begin{enumerate}
    \item $\crit(\cM) \geq \tfrac{\zeta_n}{2} $;
    \item $\firstdeath{m}{\cM} < \tfrac{\zeta_n}{4}+\tfrac{\zeta_m}{2}$ for any $m \in \N$.
    \item There exists $\theta \in \cO(\ell, m)$ with \(\ell \neq m\) such that $\img_\theta(\cM) \neq 0$.
\end{enumerate}

\medskip As shown in \cref{s:critical_radii_rpn}, round real projective spaces of radius \(\pi\) satisfy these Desiderata.
For fixed $n\in \N$ and the round Lens space $\rL^n_p$ of radius \(\pi\), Desideratum (3) is achieved by selecting $\theta$ as an appropriate Steenrod reduced power (see \cref{sss:cohomology_lens}).
Desideratum (1) remains unproven, but for Desideratum (2) by \cref{s:critical_radii_lens} it suffices to check that
\[
\fillrad(\rL^1_p) \leq \dotsb \leq \fillrad(\rL^n_p) < \tfrac{3\zeta_{2n+1}}{4}.
\anibal{What is \(m\)? This is not a math statement. The \(n\) was fixed, but now is a parameter. \ling{fixed}}
\]

% We now explain why these two conditions are sufficient.
% Desideratum (1) as just being restated as Condition (a).
% To show that Condition (b) implies Desideratum (2), we apply an argument similar to that in the second part of the proof of \cref{s:critical_radii_rpn}.
% It is enough to consider odd homology degrees, since $\firstdeath{m}{\rL^n_p} = 0$ when $m$ is even.
% By \cref{subsub:system VR compatible}, the $\rC_p$-action on the system $\bS^1 \subset \bS^3 \subset \bS^5 \subset \dotsb$ is \(\VR\)-compatible.
% This, combined with the assumption that $\fillrad(\rL^n_p)$ is non-decreasing in $n$, meets the conditions of \cref{ss:fundamental_lemma}, implying that for any odd integer $m \leq 2n+1$
% \[
% \firstdeath{m}{\rL^n_p} \leq \fillrad(\rL^n_p).
% \]
% With the assumption $\fillrad(\rL^n_p) < \tfrac{\zeta_{2n+1}}{4} + \tfrac{\zeta_{m}}{2}$, we conclude that $\firstdeath{m}{\rL^n_p} < \tfrac{\zeta_{2n+1}}{4} + \tfrac{\zeta_{m}}{2}$.
% Thus, desiderata (2) also holds.

\subsubsection{}

Let \(\cM\) be a closed connected Riemannian \(n\)-manifold of radius \(\pi\) satisfying our Desiderata.
Let $\bS_{\cM}$ be the wedge sum of spheres of radius \(\pi\) with the same reduced homology groups as $\cM$.

\medskip\theorem
There is $\ell, m \in \N$ and $\theta \in \cO(\ell, m)$ such that
\begin{equation}\label{eq:comparison}
    \di \Big(\rH^{\VR}_{m}(\bS_{\cM}),\, \rH^{\VR}_{m}(\cM)\Big) < \di \big(\img^{\VR}_{\theta}(\bS_{\cM}),\, \img^{\VR}_{\theta}(\cM)\big).
\end{equation}

The proof of this theorem involves the following three steps, which we will respectively prove in \cref{sss:db_upper_bound}, \cref{sss:db_theta_lower_bound}, and \cref{sss:comparison_lemma_zeta_n}.
\begin{enumerate}
    \item [(a)] LHS of \cref{eq:comparison} is bounded above by $\max\big\{|\zeta_m  - 2\firstdeath{m}{\cM} |, \tfrac{\pi - \zeta_n}{2}\big\}$.
    \item [(b)] RHS of \cref{eq:comparison} is bounded below by $\min\{\firstdeath{\theta}{\cM}, \zeta_n\}$.
    \item [(c)] The value in (a) is strictly less than the value in (b).
\end{enumerate}
% Thus, LHS of \cref{eq:comparison} is strictly less than RHS of \cref{eq:comparison}.

\subsubsection{}\label{sss:db_upper_bound}

\medskip\lemma
If \( \opH_m(\cM) \) is non-zero, then
\begin{equation}\label{eq:db_usual_upper_bound}
    \di\Big(\rH^{\VR}_{m}(\bS_{\cM}),\, \rH^{\VR}_{m}(\cM)\Big)
	\leq \max\big\{|\zeta_m  - 2\firstdeath{m}{\cM} |,\, \tfrac{\pi - \zeta_n}{2}\big\}.
\end{equation}
If \( \opH_m(\cM) \) is zero, a similar result holds, with the upper bound being $\tfrac{\pi - \zeta_n}{2}$.

\begin{proof}
    Because both metric spaces are totally bounded, their persistent homology is q-tame.
    By \cref{ss:algebraic_stability}, the interleaving distance between their persistent homology equals the bottleneck distance between the corresponding barcodes.

    To obtain an upper bound on the bottleneck distance, we only need to construct a matching and calculate its cost. Let \( \beta_m = 2\firstdeath{m}{\cM} \).

    First, suppose \( \opH_m(\cM) \) is non-zero.
    Consider the matching \( P \) between \( \Hbarc[\field]{m}{\bS_{\cM}} \) and \( \Hbarc[\field]{m}{\cM} \) such that the bar \( (0, \zeta_m) \) from \( \Hbarc[\field]{m}{\bS_{\cM}} \) is matched to \( (0, \beta_m) \) from \( \Hbarc[\field]{m}{\cM} \), with all other bars remaining unmatched. Using the estimates from \cref{fig:barcodes_general} and \cref{fig:barcodes_vs}, we find that the cost of \( P \) satisfies
    \begin{align*}
        \cost(P)
        = & \max\Big\{|\zeta_m - \beta_m|,\, \frac{\pi - \zeta_n}{2},\, \frac{\pi - 2\crit(\cM)}{2}\Big\} \\
        = & \max\Big\{|\zeta_m - \beta_m|,\, \frac{\pi - \zeta_n}{2}\Big\} \quad \text{(since \( \zeta_n \leq 2\crit(\cM) \))}.
    \end{align*}
    Thus, \cref{eq:db_usual_upper_bound} follows.

    Now, suppose \( \opH_m(\cM) \) is zero. In this case, the matching where all bars are unmatched has a cost no larger than \( \frac{\pi - \zeta_n}{2}\).
\end{proof}

\subsubsection{}\label{sss:db_theta_lower_bound}

\medskip\lemma
Let $\theta \in \cO(\ell, m)$ be such that $\img \theta_\cM$ is non-zero.
Then,
\begin{equation}\label{eq:db_theta_lower_bound}
	\di\big(\img^{\VR}_{\theta}(\bS_{\cM}), \img^{\VR}_{\theta}(\cM)\big)
	\geq \min\{\firstdeath{\theta}{\cM}, \zeta_n\}. %\geq \tfrac{\zeta_n}{2}.
\end{equation}

\begin{proof}
    Since both metric spaces are totally bounded, their persistent cohomology is q-tame, making the persistent $\img_\theta$-modules q-tame as well (see \cref{ss:theta-modules-q-tame}).
    Thus, the left-hand-side of \cref{eq:db_theta_lower_bound} can be replaced with the bottleneck distance between the corresponding $\img_\theta$-barcodes.

    To establish a lower bound on this bottleneck distance, we need to compute the minimum cost of matching specific bars.

    Let \( \gamma_\theta = 2\firstdeath{\theta}{\cM} \).
    From \cref{fig:barcodes_general}, note that \( \thetabarc{\cM} \) contains a bar \( (0, \gamma_\theta) \).
    We now calculate the minimum cost of matching this bar.

    Consider an arbitrary matching \( Q \) between \( \thetabarc{\bS_{\cM}} \) and \( \thetabarc{\cM} \).
    There are two cases to analyze.
	If $(0,\gamma_\theta )$ is unmatched in $Q$, then $\cost(Q)$ is at least $ \tfrac{\gamma_\theta }{2}$.
	If $(0,\gamma_\theta )$ is matched to some bar $(a,b) \in \thetabarc{\bS_{\cM}}$, then
	$\cost(Q) =  \|(0,\gamma_\theta ) - (a,b)\|_\infty \geq a \geq \zeta_n$, because $(a,b) \subset (\zeta_n, \pi)$.
	Thus, any matching $Q$ must satisfy $\cost(Q) \geq \min\{\tfrac{\gamma_\theta }{2}, \zeta_n\}$, which proves \cref{eq:db_theta_lower_bound}.
\end{proof}


\subsubsection{}
\label{sss:comparison_lemma}

The following results will be used in \cref{sss:comparison_lemma_zeta_n} and \cref{ss:distance_estimate_rpn}.

As before, let $\zeta_n = \arccos{(-\tfrac{1}{n+1})}$, which decreases as $n$ increases.
We derive the following lemma, which, while straightforward, requires careful exposition.

\medskip\lemma
Let $m \leq n$.
\begin{enumerate}
    \item \(\zeta_m - \zeta_n < \tfrac{\pi - \zeta_n}{2} < \tfrac{\zeta_n}{2}.\)

    \item For any $r \in \big[\zeta_n, \tfrac{\zeta_n}{2}+\zeta_m\big)$, $\max\big\{|\zeta_m  - r |, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}$.

%    \item For any $r \in \big[\zeta_n, \tfrac{\pi - \zeta_n}{2} + \zeta_m\big]$, $\max\{|\zeta_m  - r |, \tfrac{\pi - \zeta_n}{2}\} = \tfrac{\pi - \zeta_n}{2}$.
\end{enumerate}


\begin{proof}
    	(1) The first inequality follows from $\zeta_m - \zeta_n < \tfrac{\pi}{6} < \tfrac{\pi - \zeta_n}{2}$.
        The second inequality holds because $\zeta_n$ is larger than $\tfrac{\pi}{2}$.

        (2) Since $\tfrac{\pi - \zeta_n}{2}$ is less than $\tfrac{\zeta_n}{2}$, it remains to show $|\zeta_m  - r |$ is also less than $\tfrac{\zeta_n}{2}$, which follows from
    	\(
    	|\zeta_m  - r | < \max\big\{\zeta_m - \zeta_n, \tfrac{\zeta_n}{2}\big\} = \tfrac{\zeta_n}{2},
    	\) by Part (1).
    	% (3) It suffices to show $|\zeta_m  - r | \leq \tfrac{\pi - \zeta_n}{2}$.
     %    We consider two cases.
     %    When $r$ is larger than $\zeta_m$, we have
    	% $|\zeta_m  - r | = r - \zeta_m \leq
    	% %\leq \tfrac{\pi - \zeta_n}{2} + \zeta_m - \zeta_m =
     %    \tfrac{\pi - \zeta_n}{2}
    	% $ by the assumption on $r$.
    	% When $r$ is less than or equal to $\zeta_m$, we have
    	% \(
    	% |\zeta_m  - r | \leq \zeta_m - \zeta_n
    	% < \tfrac{\pi - \zeta_n}{2}
    	% \) by Part (1).
\end{proof}

\subsubsection{}
\label{sss:comparison_lemma_zeta_n}

We will finish the proof of \cref{ss:genberal_distance_comparison} by completing the third step.
%demonstrating that the upper bound on the interleaving distance for the persistent homology is strictly less than the lower bound for the interleaving distance between the persistent $\img_\theta$-modules.

\medskip \lemma
For any $m \in \N$ and $\theta \in \cO(\ell, m)$ such that $\img \theta_\cM$ is non-zero,
\[\max\big\{|\zeta_m  - 2\firstdeath{m}{\cM} |, \tfrac{\pi - \zeta_n}{2}\big\} < \min\{\firstdeath{\theta}{\cM}, \zeta_n\}.\]
\begin{proof}
    Let $\beta_m = 2\firstdeath{m}{\cM}$ and $\gamma_\theta = 2\firstdeath{\theta}{\cM}$.
    Because \(\zeta_n \leq 2\crit(\cM) \leq \beta_m < \tfrac{\zeta_n}{2} + \zeta_m\), $\beta_m$ satisfies the condition in Part (2) of the above lemma.
    Thus, we have the leftmost inequality below:
    \[
    \max\big\{|\zeta_m - \beta_m|, \tfrac{\pi - \zeta_n}{2}\big\} < \tfrac{\zeta_n}{2}
    \leq
    \min\big\{\tfrac{\gamma_\theta}{2}, \zeta_n\big\}.
    \]
    To obtain the rightmost inequality, note that \(\zeta_n \leq 2\crit(\cM) \leq \gamma_\theta\).
\end{proof}

\subsection{Real projective spaces}\label{ss:distance_estimate_rpn}

As stated earlier, the round \(\rp^n\) of radius \(\pi\) satisfies our Desiderata, so the discussions in the previous subsection applies.
In particular, we obtain a precise estimate of the interleaving distances. 
Let \(\bS_{\rp^n} = \bS^1 \vee \dots \vee \bS^n\) as before.
Then, we have the following result.

\medskip\corollary
(1) For any \(n,m \in \N\),
\[
\di\Big(\rH^\VR_m(\bS_{\rp^n}),\, \rH^\VR_m(\rp^n)\Big) < \frac{\pi - \zeta_n}{2}.
\]

\noindent (2) For any \(n,m,k \in \N\) such that $m \leq n,\, k \leq \tfrac{n-1}{2},\, \binom{m-k}{k}$ is odd, and $\Sq^k\in \cO(m-k, k)$,
\[
\di\Big(\img_{\Sq^k}^\VR(\bS_{\rp^n}),\, \img_{\Sq^k}^\VR(\rp^n)\Big) \geq \frac{\pi}{3}.
\]

\begin{proof}
    (1) %Let $\beta_m = 2\firstdeath{m}{\rp^n}$.
    When $1 \leq m \leq n$, we have shown in \cref{s:critical_radii_rpn} that
    $2\firstdeath{m}{\rp^n} = \tfrac{2\pi}{3}$.
    Thus, the upper bound we computed in \cref{eq:db_usual_upper_bound} on the interleaving distance between persistent homology evaluates as
    \[\max\big\{|\zeta_m  - 2\firstdeath{m}{\cM} |, \tfrac{\pi - \zeta_n}{2}\big\} = 
    \max \big\{ |\zeta_m  - \tfrac{2\pi}{3} |, \tfrac{\pi - \zeta_n}{2} \big\}
    = \tfrac{\pi - \zeta_n}{2}.
    \]
    Here, we applied \cref{sss:comparison_lemma} to deduce that $|\zeta_m  - \tfrac{2\pi}{3} | = \zeta_1 - \zeta_m < \tfrac{\pi - \zeta_1}{2} \leq \tfrac{\pi - \zeta_n}{2}$.
 
    (2) With $n,k,\Sq^k$ satisfying the required conditions, we have shown in \cref{s:critical_radii_rpn} that
	$\firstdeath{\Sq^k}{\rp^n} = \tfrac{2\pi}{3}$.
    Applying \cref{eq:db_theta_lower_bound}, we have
	\[\di\Big(\img_{\Sq^k}^\VR(\bS_{\rp^n}),\, \img_{\Sq^k}^\VR(\rp^n)\Big)
	\geq \min\Big\{\tfrac{\pi}{3},\, \zeta_n\Big\}
	= \tfrac{\pi}{3}.\qedhere
    \]
\end{proof}

The difference between $\frac{\pi - \zeta_n}{2}$ and $\frac{\pi}{3}$ is no larger than $\frac{\pi}{12}$, since \(\tfrac{\pi - \zeta_n}{2}\) does not exceed \(\tfrac{\pi}{4}\).
%As \(n\) grows, \(\tfrac{\pi - \zeta_n}{2}\) increases and approaches \(\tfrac{\pi}{4}\).
\anibal{It seems that the inequality became sharper in the wrong direction tho? 
\ling{I think `shaper' should be talked about for a fixed $n$.
By the way, I found a way to prove the $\rp^n$ result as a corollary of the previous section (not a corollary of the theorem, because the theorem does not include the bounds).}}